                   # 1 "kernel/exceptions3.mms"
                   # 1 "<built-in>"
                   # 1 "<command-line>"
                   # 1 "kernel/exceptions3.mms"
                   %
                   % exceptions3.mms -- test exception because of invalid rV in usermode
                   %
                   
                     % segmentsizes: 0,0,0,0; pageSize=2^49; r=0x90000; n=256
                     LOC #8000
0000000000008000:  RV OCTA #0000310000090800
 ...000: 00003100
 ...004: 00090800
                   
                     LOC #00090008
0000000000090008:    OCTA #0000000000002801 % PTE 1 (#0000000000002000 .. #0000000000003FFF)
 ...008: 00000000
 ...00c: 00002801
                   
                     % dynamic trap address
                     LOC #600000
                   
0000000000600000:  ATRAP GET $1,rWW % get rWW - 4
 ...000: fe01001c
 ...004: 27010104    SUBU $1,$1,4
 ...008: fe020010    GET $2,rQ
 ...00c: fe03001d    GET $3,rXX
 ...010: 3f030320    SRU $3,$3,32
 ...014: 00000000    TRAP 0 % quit
                   
                   
                     LOC #1000
                   
                     % first setup paging
0000000000001000:  Main SETL $0,RV
 ...000: e3008000
 ...004: e8008000    ORH $0,#8000
 ...008: 8f000000    LDOU $0,$0
 ...00c: f6120000    PUT rV,$0
                   
                     % global registers are better here because of PUSH/POP
 ...010: f7130080    PUT rG,128
                     % setup rTT
 ...014: e0008000    SETH $0,#8000
 ...018: e9000000    ORMH $0,ATRAP>>32
 ...01c: ea000060    ORML $0,ATRAP>>16
******************   ORL $0,ATRAP>>0
************ warning: YZ field doesn't fit in two bytes
 ...020: eb000000
 ...024: f60e0000    PUT rTT,$0
                     % setup address for results
 ...028: e0fe8000    SETH $254,#8000
 ...02c: ebfe4000    ORL $254,#4000
                     % set rK
 ...030: e10000fe    SETMH $0,#00FE
 ...034: f60f0000    PUT rK,$0
                   
                     % now go to user-mode (we are at #8000000000001000 atm)
 ...038: e300000f    SETL $0,#000F
 ...03c: e90000ff    ORMH $0,#00FF % have to be set in usermode
 ...040: c1ff0000    SET $255,$0
 ...044: e3002000    SET $0,#2000
 ...048: f61c0000    PUT rWW,$0
 ...04c: e0008000    SETH $0,#8000
 ...050: f61d0000    PUT rXX,$0
 ...054: e3010000    SET $1,0
 ...058: e3020000    SET $2,0
 ...05c: e3030000    SET $3,0
 ...060: f9000001    RESUME 1
                   
                   
                     LOC #2000
                   
0000000000002000:  LOOP SET $0,0 % rV is invalid, so it should raise an exception here
 ...000: e3000000
 ...004: f1ffffff    JMP LOOP

Symbol table:
 ATRAP = #0000000000600000 (3)
 LOOP = #0000000000002000 (4)
 Main = #0000000000001000 (1)
 RV = #0000000000008000 (2)
